---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.2
  name: datasources.knowledge.cortex
spec:
  group: knowledge.cortex
  names:
    kind: Datasource
    listKind: DatasourceList
    plural: datasources
    singular: datasource
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.type
      name: Type
      type: string
    - jsonPath: .spec.operator
      name: Operator
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Created
      type: date
    - jsonPath: .status.lastSynced
      name: Synced
      type: date
    - jsonPath: .status.took
      name: Took
      type: string
    - jsonPath: .status.nextSyncTime
      name: Next
      type: string
    - jsonPath: .status.numberOfObjects
      name: Objects
      type: integer
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Datasource is the Schema for the datasources API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of Datasource
            properties:
              databaseSecretRef:
                description: |-
                  Database credentials to use for the datasource.
                  The secret should contain the following keys:
                  - "username": The database username.
                  - "password": The database password.
                  - "host": The database host.
                  - "port": The database port.
                  - "database": The database name.
                properties:
                  name:
                    description: name is unique within a namespace to reference a
                      secret resource.
                    type: string
                  namespace:
                    description: namespace defines the space within which the secret
                      name must be unique.
                    type: string
                type: object
                x-kubernetes-map-type: atomic
              openstack:
                description: |-
                  If given, configures an OpenStack datasource to fetch.
                  Type must be set to "openstack" if this is used.
                properties:
                  cinder:
                    description: |-
                      Datasource for openstack cinder.
                      Only required if Type is "cinder".
                    properties:
                      type:
                        description: The type of resource to sync.
                        type: string
                    required:
                    - type
                    type: object
                  identity:
                    description: |-
                      Datasource for openstack identity.
                      Only required if Type is "identity".
                    properties:
                      type:
                        description: The type of resource to sync.
                        type: string
                    required:
                    - type
                    type: object
                  limes:
                    description: |-
                      Datasource for openstack limes.
                      Only required if Type is "limes".
                    properties:
                      type:
                        description: The type of resource to sync.
                        type: string
                    required:
                    - type
                    type: object
                  manila:
                    description: |-
                      Datasource for openstack manila.
                      Only required if Type is "manila".
                    properties:
                      type:
                        description: The type of resource to sync.
                        type: string
                    required:
                    - type
                    type: object
                  nova:
                    description: |-
                      Datasource for openstack nova.
                      Only required if Type is "nova".
                    properties:
                      deletedServersChangesSinceMinutes:
                        description: |-
                          Time frame in minutes for the changes-since parameter when fetching
                          deleted servers. Set if the Type is "deletedServers".
                        type: integer
                      type:
                        description: The type of resource to sync.
                        type: string
                    required:
                    - type
                    type: object
                  placement:
                    description: |-
                      Datasource for openstack placement.
                      Only required if Type is "placement".
                    properties:
                      type:
                        description: The type of resource to sync.
                        type: string
                    required:
                    - type
                    type: object
                  secretRef:
                    description: |-
                      Keystone credentials secret ref for authenticating with openstack.
                      The secret should contain the following keys:
                      - "availability": The service availability, e.g. "public", "internal", or "admin".
                      - "url": The keystone auth URL.
                      - "username": The keystone username.
                      - "password": The keystone password.
                      - "userDomainName": The keystone user domain name.
                      - "projectName": The keystone project name.
                      - "projectDomainName": The keystone project domain name.
                    properties:
                      name:
                        description: name is unique within a namespace to reference
                          a secret resource.
                        type: string
                      namespace:
                        description: namespace defines the space within which the
                          secret name must be unique.
                        type: string
                    type: object
                    x-kubernetes-map-type: atomic
                  syncInterval:
                    default: 60s
                    description: How often to sync the datasource.
                    type: string
                  type:
                    description: The type of the OpenStack datasource.
                    type: string
                required:
                - secretRef
                - syncInterval
                - type
                type: object
              operator:
                description: The operator by which this datasource should be synced.
                type: string
              prometheus:
                description: |-
                  If given, configures a Prometheus datasource to fetch.
                  Type must be set to "prometheus" if this is used.
                properties:
                  alias:
                    description: |-
                      Especially when a more complex query is used, we need an alias
                      under which the table will be stored in the database.
                      Additionally, this alias is used to reference the metric in the
                      feature extractors as dependency.
                    type: string
                  interval:
                    default: 86400s
                    description: The interval at which to query the data.
                    type: string
                  query:
                    description: The query to use to fetch the metric.
                    type: string
                  resolution:
                    default: 43200s
                    description: The resolution of the data.
                    type: string
                  secretRef:
                    description: |-
                      Secret containing the following keys:
                      - "url": The prometheus URL.
                    properties:
                      name:
                        description: name is unique within a namespace to reference
                          a secret resource.
                        type: string
                      namespace:
                        description: namespace defines the space within which the
                          secret name must be unique.
                        type: string
                    type: object
                    x-kubernetes-map-type: atomic
                  timeRange:
                    default: 2419200s
                    description: Time range to query the data for.
                    type: string
                  type:
                    description: |-
                      The type of the metric, mapping directly to a metric model supported
                      by cortex. Note that the metrics are fetched as time series, not instant.
                    type: string
                required:
                - alias
                - interval
                - query
                - resolution
                - secretRef
                - timeRange
                - type
                type: object
              ssoSecretRef:
                description: |-
                  Kubernetes secret ref for an optional sso certificate to access the host.
                  The secret should contain two keys: "cert" and "key".
                properties:
                  name:
                    description: name is unique within a namespace to reference a
                      secret resource.
                    type: string
                  namespace:
                    description: namespace defines the space within which the secret
                      name must be unique.
                    type: string
                type: object
                x-kubernetes-map-type: atomic
              type:
                description: The type of the datasource.
                type: string
            required:
            - databaseSecretRef
            - type
            type: object
          status:
            description: status defines the observed state of Datasource
            properties:
              conditions:
                description: The current status conditions of the datasource.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              lastSynced:
                description: When the datasource was last successfully synced.
                format: date-time
                type: string
              nextSyncTime:
                description: Planned time for the next sync.
                format: date-time
                type: string
              numberOfObjects:
                description: The number of objects currently stored for this datasource.
                format: int64
                type: integer
              took:
                description: The time it took to perform the last sync.
                type: string
            required:
            - took
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
